<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>IJZEREEN :: Digital Chaos</title>
    <meta name="description" content="PlayGround">
    
    <!-- Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@300;400;700;800&family=Inter:wght@200;300;400;500;600;700;800;900&display=swap" rel="stylesheet">
    
    <!-- Tailwind CSS CDN for quick prototyping -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <style>
        /* Custom animations and styles */
        @keyframes glitch {
            0% { transform: translate(0); }
            20% { transform: translate(-2px, 2px); }
            40% { transform: translate(-2px, -2px); }
            60% { transform: translate(2px, 2px); }
            80% { transform: translate(2px, -2px); }
            100% { transform: translate(0); }
        }
        
        @keyframes float {
            0%, 100% { transform: translateY(0px) rotate(0deg); }
            25% { transform: translateY(-10px) rotate(5deg); }
            50% { transform: translateY(0px) rotate(10deg); }
            75% { transform: translateY(5px) rotate(15deg); }
        }
        
        @keyframes scanlines {
            0% { background-position: 0 0; }
            100% { background-position: 0 40px; }
        }
        
        @keyframes fadeOut {
            0% { opacity: 1; transform: scale(1) rotate(var(--rotation, 0deg)); }
            100% { opacity: 0; transform: scale(0.8) rotate(var(--rotation, 0deg)); }
        }
        
        @keyframes fadeIn {
            0% { opacity: 0; transform: scale(0.8) rotate(var(--rotation, 0deg)); }
            100% { opacity: 1; transform: scale(1) rotate(var(--rotation, 0deg)); }
        }
        
        .glitch {
            animation: glitch 1s infinite;
        }
        
        .float {
            animation: float 4s ease-in-out infinite;
        }
        
        .noise-overlay {
            background: repeating-linear-gradient(
                0deg,
                rgba(255,255,255,.04) 0px,
                rgba(255,255,255,.04) 1px,
                transparent 1px,
                transparent 2px
            );
            animation: scanlines 2s infinite linear;
        }
        
        .drag-element {
            cursor: grab;
            user-select: none;
        }
        
        .drag-element:active {
            cursor: grabbing;
        }
        
        .window-chrome {
            box-shadow: 12px 12px 0 0 #000;
        }
        
        .brutal-shadow {
            box-shadow: 6px 6px 0 0 #000;
        }
        
        .selection\\:bg-black::selection {
            background: #000;
            color: #fff;
        }
        
        /* Custom scrollbar */
        ::-webkit-scrollbar {
            width: 12px;
        }
        
        ::-webkit-scrollbar-track {
            background: #f1f1f1;
            border: 2px solid #000;
        }
        
        ::-webkit-scrollbar-thumb {
            background: #000;
            border: 2px solid #fff;
        }
        
        ::-webkit-scrollbar-thumb:hover {
            background: #666;
        }
        
        /* Filter buttons */
        .filter-btn.active {
            background: #000 !important;
            color: #fff !important;
        }
        
        .post-item {
            transition: all 0.3s ease;
        }
        
        .post-item.hidden {
            display: none;
        }
    </style>
</head>
<body class="min-h-screen bg-white text-black overflow-hidden selection:bg-black selection:text-white">
    
    <!-- Noise Overlay -->
    <div class="noise-overlay pointer-events-none fixed inset-0 mix-blend-overlay opacity-20 z-10"></div>
    
    <!-- Crop Mark -->
    <div class="fixed left-3 top-3 w-10 h-10 border-2 border-black rounded-full opacity-40 z-20"></div>
    
    <!-- Header -->
    <header class="sticky top-0 z-[1000] border-b-4 border-black bg-white/90 backdrop-blur px-4 md:px-8 py-3 flex items-center justify-between">
        <div class="uppercase text-xl lg:text-2xl tracking-widest font-black">
            <a href="/">PlayGround</a>
        </div>
        <nav class="flex items-center gap-1 lg:gap-2">
            <button id="search-btn" class="border-4 border-black px-2 lg:px-3 py-1 brutal-shadow hover:bg-gray-100 transition-colors text-xs lg:text-sm">Search</button>
            <button id="randomize-btn" class="hidden sm:block border-4 border-black px-2 lg:px-3 py-1 brutal-shadow hover:bg-gray-100 transition-colors text-xs lg:text-sm">Randomize</button>
            <button id="restore-btn" class="hidden sm:block border-4 border-black px-2 lg:px-3 py-1 bg-green-200 brutal-shadow hover:bg-green-300 transition-colors text-xs lg:text-sm">Restore</button>
        </nav>
    </header>
    
    <main class="relative min-h-[70vh]">
        <div class="mx-auto max-w-7xl px-4 md:px-8 flex flex-col lg:flex-row gap-4 lg:gap-8 pt-6 lg:pt-10">
            <!-- Main content area -->
            <div class="flex-1 order-2 lg:order-1">
                <!-- Posts grid -->
                <div id="posts-grid" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 lg:gap-6 pb-32">
                    
                    <div class="post-item relative border-4 border-black bg-white p-4 brutal-shadow rotate-[-0.6deg] hover:rotate-[1deg] transition-transform duration-300" 
                         data-categories="nlp,ai"
                         data-tags="bm25s,kkma,okt,kiwi">
                        <h3 class="font-mono text-xl md:text-2xl mb-2 underline decoration-dotted">
                            <a href="/posts/Lexical-Search/">bm25와 한국어 토크나이저를 활용한 Lexical Search 개선</a>
                        </h3>
                        <p class="text-sm leading-5 font-mono">Lexical Search
</p>
                        <div class="mt-2 text-xs text-gray-600">
                            2025.08.11
                            
                            • NLP, AI
                            
                        </div>
                    </div>
                    
                    <div class="post-item relative border-4 border-black bg-white p-4 brutal-shadow rotate-[-0.6deg] hover:rotate-[1deg] transition-transform duration-300" 
                         data-categories="design,web"
                         data-tags="neobrutalism,design,web,ui,ux">
                        <h3 class="font-mono text-xl md:text-2xl mb-2 underline decoration-dotted">
                            <a href="/posts/neobrutalism-design/">네오브루탈리즘 웹디자인의 새로운 물결</a>
                        </h3>
                        <p class="text-sm leading-5 font-mono">디지털 시대의 반란: 네오브루탈리즘
</p>
                        <div class="mt-2 text-xs text-gray-600">
                            2025.08.10
                            
                            • Design, Web
                            
                        </div>
                    </div>
                    
                    <div class="post-item relative border-4 border-black bg-white p-4 brutal-shadow rotate-[-0.6deg] hover:rotate-[1deg] transition-transform duration-300" 
                         data-categories="philosophy,digital"
                         data-tags="chaos,order,digital,art,philosophy">
                        <h3 class="font-mono text-xl md:text-2xl mb-2 underline decoration-dotted">
                            <a href="/posts/digital-chaos-blog/">디지털 혼돈 속에서 찾는 질서</a>
                        </h3>
                        <p class="text-sm leading-5 font-mono">혼돈의 미학
</p>
                        <div class="mt-2 text-xs text-gray-600">
                            2025.08.09
                            
                            • Philosophy, Digital
                            
                        </div>
                    </div>
                    
                </div>
            </div>
            
            <!-- Right Sidebar -->
            <div class="w-full lg:w-80 space-y-4 lg:space-y-6 mb-6 lg:mb-0 order-1 lg:order-2">
                <!-- Categories Board -->
                <div class="border-4 border-black bg-yellow-200 p-3 lg:p-4 brutal-shadow lg:sticky lg:top-24">
                    <h2 class="text-lg lg:text-xl font-black mb-2 lg:mb-3 tracking-widest">CATEGORIES</h2>
                    <div class="flex flex-wrap gap-1 lg:gap-2">
                        <button onclick="filterPosts('all')" class="filter-btn category-btn border-2 border-black px-2 lg:px-3 py-1 bg-white hover:bg-gray-100 transition-colors text-xs font-mono uppercase active" data-filter="all">ALL</button>
                        
                        
                        
                        <button onclick="filterPosts('category', 'AI')" class="filter-btn category-btn border-2 border-black px-2 lg:px-3 py-1 bg-white hover:bg-gray-100 transition-colors text-xs font-mono uppercase" data-filter="AI">AI</button>
                        
                        
                        
                        <button onclick="filterPosts('category', 'Design')" class="filter-btn category-btn border-2 border-black px-2 lg:px-3 py-1 bg-white hover:bg-gray-100 transition-colors text-xs font-mono uppercase" data-filter="Design">Design</button>
                        
                        
                        
                        <button onclick="filterPosts('category', 'Digital')" class="filter-btn category-btn border-2 border-black px-2 lg:px-3 py-1 bg-white hover:bg-gray-100 transition-colors text-xs font-mono uppercase" data-filter="Digital">Digital</button>
                        
                        
                        
                        <button onclick="filterPosts('category', 'NLP')" class="filter-btn category-btn border-2 border-black px-2 lg:px-3 py-1 bg-white hover:bg-gray-100 transition-colors text-xs font-mono uppercase" data-filter="NLP">NLP</button>
                        
                        
                        
                        <button onclick="filterPosts('category', 'Philosophy')" class="filter-btn category-btn border-2 border-black px-2 lg:px-3 py-1 bg-white hover:bg-gray-100 transition-colors text-xs font-mono uppercase" data-filter="Philosophy">Philosophy</button>
                        
                        
                        
                        <button onclick="filterPosts('category', 'Web')" class="filter-btn category-btn border-2 border-black px-2 lg:px-3 py-1 bg-white hover:bg-gray-100 transition-colors text-xs font-mono uppercase" data-filter="Web">Web</button>
                        
                        
                    </div>
                </div>
                
                <!-- Tags Board -->
                <div class="border-4 border-black bg-green-200 p-3 lg:p-4 brutal-shadow">
                    <h2 class="text-lg lg:text-xl font-black mb-2 lg:mb-3 tracking-widest">TAGS</h2>
                    <div class="flex flex-wrap gap-1">
                        
                        
                        
                        <button onclick="filterPosts('tag', 'Kiwi')" class="filter-btn tag-btn border-2 border-black px-2 py-1 bg-white hover:bg-gray-100 transition-colors text-xs font-mono cursor-pointer">#Kiwi</button>
                        
                        
                        
                        <button onclick="filterPosts('tag', 'Kkma')" class="filter-btn tag-btn border-2 border-black px-2 py-1 bg-white hover:bg-gray-100 transition-colors text-xs font-mono cursor-pointer">#Kkma</button>
                        
                        
                        
                        <button onclick="filterPosts('tag', 'OKT')" class="filter-btn tag-btn border-2 border-black px-2 py-1 bg-white hover:bg-gray-100 transition-colors text-xs font-mono cursor-pointer">#OKT</button>
                        
                        
                        
                        <button onclick="filterPosts('tag', 'art')" class="filter-btn tag-btn border-2 border-black px-2 py-1 bg-white hover:bg-gray-100 transition-colors text-xs font-mono cursor-pointer">#art</button>
                        
                        
                        
                        <button onclick="filterPosts('tag', 'bm25s')" class="filter-btn tag-btn border-2 border-black px-2 py-1 bg-white hover:bg-gray-100 transition-colors text-xs font-mono cursor-pointer">#bm25s</button>
                        
                        
                        
                        <button onclick="filterPosts('tag', 'chaos')" class="filter-btn tag-btn border-2 border-black px-2 py-1 bg-white hover:bg-gray-100 transition-colors text-xs font-mono cursor-pointer">#chaos</button>
                        
                        
                        
                        <button onclick="filterPosts('tag', 'design')" class="filter-btn tag-btn border-2 border-black px-2 py-1 bg-white hover:bg-gray-100 transition-colors text-xs font-mono cursor-pointer">#design</button>
                        
                        
                        
                        <button onclick="filterPosts('tag', 'digital')" class="filter-btn tag-btn border-2 border-black px-2 py-1 bg-white hover:bg-gray-100 transition-colors text-xs font-mono cursor-pointer">#digital</button>
                        
                        
                        
                        <button onclick="filterPosts('tag', 'neobrutalism')" class="filter-btn tag-btn border-2 border-black px-2 py-1 bg-white hover:bg-gray-100 transition-colors text-xs font-mono cursor-pointer">#neobrutalism</button>
                        
                        
                        
                        <button onclick="filterPosts('tag', 'order')" class="filter-btn tag-btn border-2 border-black px-2 py-1 bg-white hover:bg-gray-100 transition-colors text-xs font-mono cursor-pointer">#order</button>
                        
                        
                        
                        <button onclick="filterPosts('tag', 'philosophy')" class="filter-btn tag-btn border-2 border-black px-2 py-1 bg-white hover:bg-gray-100 transition-colors text-xs font-mono cursor-pointer">#philosophy</button>
                        
                        
                        
                        <button onclick="filterPosts('tag', 'ui')" class="filter-btn tag-btn border-2 border-black px-2 py-1 bg-white hover:bg-gray-100 transition-colors text-xs font-mono cursor-pointer">#ui</button>
                        
                        
                        
                        <button onclick="filterPosts('tag', 'ux')" class="filter-btn tag-btn border-2 border-black px-2 py-1 bg-white hover:bg-gray-100 transition-colors text-xs font-mono cursor-pointer">#ux</button>
                        
                        
                        
                        <button onclick="filterPosts('tag', 'web')" class="filter-btn tag-btn border-2 border-black px-2 py-1 bg-white hover:bg-gray-100 transition-colors text-xs font-mono cursor-pointer">#web</button>
                        
                        
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Floating image windows container -->
        <div id="floating-windows"></div>
        
        <!-- Text window -->
        <div id="text-window" class="drag-element absolute border-4 border-black bg-white window-chrome" style="width: 380px; height: 220px; top: 100px; left: 50px; z-index: 800; display: none;">
            <div class="flex items-center justify-between border-b-4 border-black bg-gray-100 px-2 py-1">
                <div class="flex gap-1">
                    <div onclick="closeTextWindow()" class="w-3 h-3 bg-black animate-ping cursor-pointer hover:bg-red-500 transition-colors"></div>
                    <div class="w-3 h-3 border-2 border-black"></div>
                    <div class="w-3 h-3 bg-white border-2 border-black -rotate-45"></div>
                </div>
                <span class="text-[10px] uppercase tracking-widest">window</span>
            </div>
            <div class="p-4 text-[12px] leading-5">
                <h3 class="font-bold mb-2 italic underline decoration-wavy decoration-pink-500">Ijzereen, how are you?</h3>
                <p class="whitespace-pre-wrap font-mono leading-relaxed">PlayGround</p>
            </div>
        </div>
        
        <!-- Draggable badge -->
        <div id="badge" class="drag-element absolute left-6 bottom-6 z-[900] bg-white border-4 border-black p-3 w-44 brutal-shadow rotate-[0.8deg]" style="display: none;">
            <button onclick="closeBadge()" class="absolute -top-2 -right-2 w-6 h-6 bg-red-500 border-2 border-black text-white text-xs font-bold leading-none hover:bg-red-600 transition-colors rounded-full">×</button>
            <div class="text-[10px] mb-1">ID: IJZEREEN / ISSUED: TODAY</div>
            <div class="text-lg font-black">THE PRESIDENT</div>
            <div class="h-20 mt-2 bg-gray-300 border-2 border-black flex items-center justify-center text-xs">
                PORTRAIT
            </div>
        </div>
    </main>
    
    <!-- Footer -->
    <footer class="relative">
        <div class="fixed right-4 lg:right-6 bottom-4 text-sm z-10">
            <a class="underline font-mono font-bold" href="/about">Who is 철원</a>
        </div>
    </footer>
    
    <!-- Search Modal -->
    <div id="search-modal" class="fixed inset-0 z-[2000] bg-white/95 backdrop-blur flex items-center justify-center hidden">
        <div class="relative border-4 border-black bg-white p-6 window-chrome max-w-2xl w-full mx-4 max-h-[80vh] overflow-hidden flex flex-col">
            <button id="close-search" class="absolute -top-3 -right-3 bg-black text-white text-xs px-2 py-1 border-2 border-black hover:bg-red-500 transition-colors">X</button>
            <div class="text-center mb-4">
                <div class="text-2xl font-black tracking-widest mb-4">SEARCH</div>
                <input type="text" id="search-input" placeholder="제목, 내용, 카테고리, 태그로 검색..." class="border-4 border-black p-3 w-full font-mono text-left" autofocus>
            </div>
        </div>
    </div>
    
    <!-- Global CHAOS button - Always visible -->
    <div id="global-chaos-btn" class="fixed bottom-16 left-4 lg:bottom-8 lg:left-8 w-12 h-12 lg:w-16 lg:h-16 border-4 border-black bg-pink-200 cursor-pointer brutal-shadow hover:bg-pink-300 transition-colors flex items-center justify-center font-mono font-bold text-[8px] lg:text-xs rotate-12 z-[1500]">
        CHAOS
    </div>
    
    <script>
        // Global state
        let glitchMode = localStorage.getItem('chaos-mode') === 'true';
        let chaosMode = localStorage.getItem('chaos-mode') === 'true';
        let windowCount = 2; // 기본값, imageConfig에서 초기화됨
        let dragElements = [];
        let chaosInterval = null;
        
        // Popup management with 1-hour timeout
        function isPopupHidden(popupId) {
            const hiddenTime = localStorage.getItem(`hidden_${popupId}`);
            if (!hiddenTime) return false;
            
            const oneHour = 60 * 60 * 1000; // 1 hour in milliseconds
            const now = new Date().getTime();
            
            if (now - parseInt(hiddenTime) > oneHour) {
                localStorage.removeItem(`hidden_${popupId}`);
                return false;
            }
            return true;
        }
        
        function hidePopupForHour(popupId) {
            localStorage.setItem(`hidden_${popupId}`, new Date().getTime().toString());
        }
        
        // Image sources configuration - 이곳에서 이미지를 제어할 수 있습니다
        const imageConfig = {
            // 기본 이미지 개수
            defaultCount: 2,
            
            // 최대 이미지 개수 제한
            maxCount: 3,
            
            // 사용할 이미지 소스들 (assets/img/floating/ 폴더의 이미지들)
            sources: [
                '/assets/img/floating/sample1.svg?v=1754912052',
                '/assets/img/floating/sample2.svg?v=1754912052',
                '/assets/img/floating/sample3.svg?v=1754912052'
            ],
            
            // 창 크기 범위
            width: { min: 280, max: 460 },
            height: { min: 180, max: 320 },
            
            // 회전 범위 (도)
            rotation: { min: -7, max: 7 }
        };
        
        
        // Utility functions
        function rand(min, max) {
            return Math.random() * (max - min) + min;
        }
        
        function shuffle(arr) {
            return [...arr].sort(() => Math.random() - 0.5);
        }
        
        // Create floating image window
        function createImageWindow(src, index) {
            const window = document.createElement('div');
            window.className = `drag-element absolute border-4 border-black bg-white window-chrome ${glitchMode && index % 2 === 0 ? 'glitch' : ''}`;
            window.style.width = rand(imageConfig.width.min, imageConfig.width.max) + 'px';
            window.style.height = rand(imageConfig.height.min, imageConfig.height.max) + 'px';
            window.style.left = rand(30, Math.max(100, window.innerWidth - 500)) + 'px';
            window.style.top = rand(30, Math.max(100, window.innerHeight - 400)) + 'px';
            window.style.zIndex = 200 + index;
            window.style.transform = `rotate(${rand(imageConfig.rotation.min, imageConfig.rotation.max)}deg)`;
            window.setAttribute('data-window-id', `window-${index}`);
            
            window.innerHTML = `
                <div class="flex items-center justify-between border-b-4 border-black bg-gray-100 px-2 py-1">
                    <div class="flex gap-1">
                        <div class="close-dot-btn w-3 h-3 bg-black animate-ping cursor-pointer hover:bg-red-500 transition-colors"></div>
                        <div class="w-3 h-3 border-2 border-black"></div>
                        <div class="w-3 h-3 bg-white border-2 border-black -rotate-45"></div>
                    </div>
                    <span class="text-[10px] uppercase tracking-widest">window</span>
                </div>
                <img src="${src}" alt="" class="w-full h-full object-cover ${glitchMode && index % 2 === 0 ? 'mix-blend-screen' : ''}">
            `;
            
            // Add close functionality for blinking dot only
            const closeWindow = (e) => {
                e.stopPropagation(); // Prevent drag from triggering
                window.style.animation = 'fadeOut 0.3s ease-out';
                
                // Hide this specific window type for 1 hour
                const windowId = window.getAttribute('data-window-id');
                hidePopupForHour(`image_window_${index}`);
                
                setTimeout(() => {
                    window.remove();
                    // Update dragElements array
                    dragElements = dragElements.filter(el => el !== window);
                }, 300);
            };
            
            const closeDot = window.querySelector('.close-dot-btn');
            closeDot.addEventListener('click', closeWindow);
            
            return window;
        }
        
        // Check if there's enough space for floating windows
        function hasEnoughSpace() {
            const screenWidth = window.innerWidth;
            const contentWidth = Math.min(screenWidth * 0.8, 1200); // 콘텐츠 최대 너비
            const sideMargin = (screenWidth - contentWidth) / 2;
            const minWindowWidth = imageConfig.width.min; // 최소 도형 너비
            
            // 좌우 여백이 도형 너비보다 작으면 공간이 부족
            return sideMargin >= minWindowWidth;
        }

        // Generate floating windows
        function generateWindows() {
            const container = document.getElementById('floating-windows');
            container.innerHTML = '';
            
            // Check if on mobile (모바일 감지)
            const isMobile = window.innerWidth < 768;
            
            // On mobile, only show floating windows when CHAOS mode is ON
            // On PC, always show floating windows (regardless of CHAOS mode)
            if (isMobile && !chaosMode) {
                return;
            }
            
            const shuffledImages = shuffle(imageConfig.sources);
            
            for (let i = 0; i < windowCount; i++) {
                // Check if this window was closed in the last hour
                if (!isPopupHidden(`image_window_${i}`)) {
                    const window = createImageWindow(shuffledImages[i % shuffledImages.length], i);
                    container.appendChild(window);
                }
            }
            
            initializeDraggables();
        }
        
        // Make elements draggable
        function initializeDraggables() {
            dragElements = document.querySelectorAll('.drag-element');
            
            dragElements.forEach(element => {
                let isDragging = false;
                let currentX;
                let currentY;
                let initialX;
                let initialY;
                let xOffset = 0;
                let yOffset = 0;
                
                function setTranslate(xPos, yPos, el) {
                    const currentTransform = el.style.transform || '';
                    const rotateMatch = currentTransform.match(/rotate\\([^)]+\\)/);
                    const rotateStr = rotateMatch ? rotateMatch[0] : '';
                    
                    el.style.transform = `translate3d(${xPos}px, ${yPos}px, 0) ${rotateStr}`;
                }
                
                function dragStart(e) {
                    if (e.type === 'touchstart') {
                        initialX = e.touches[0].clientX - xOffset;
                        initialY = e.touches[0].clientY - yOffset;
                    } else {
                        initialX = e.clientX - xOffset;
                        initialY = e.clientY - yOffset;
                    }
                    
                    if (e.target === element || element.contains(e.target)) {
                        isDragging = true;
                        element.style.zIndex = 1000;
                    }
                }
                
                function dragEnd(e) {
                    initialX = currentX;
                    initialY = currentY;
                    isDragging = false;
                    element.style.zIndex = '';
                }
                
                function drag(e) {
                    if (isDragging) {
                        e.preventDefault();
                        
                        if (e.type === 'touchmove') {
                            currentX = e.touches[0].clientX - initialX;
                            currentY = e.touches[0].clientY - initialY;
                        } else {
                            currentX = e.clientX - initialX;
                            currentY = e.clientY - initialY;
                        }
                        
                        xOffset = currentX;
                        yOffset = currentY;
                        
                        setTranslate(currentX, currentY, element);
                    }
                }
                
                // Mouse events
                element.addEventListener('mousedown', dragStart, false);
                document.addEventListener('mouseup', dragEnd, false);
                document.addEventListener('mousemove', drag, false);
                
                // Touch events
                element.addEventListener('touchstart', dragStart, false);
                document.addEventListener('touchend', dragEnd, false);
                document.addEventListener('touchmove', drag, false);
            });
        }
        
        // Event listeners
        document.getElementById('search-btn').addEventListener('click', () => {
            document.getElementById('search-modal').classList.remove('hidden');
        });
        
        document.getElementById('close-search').addEventListener('click', () => {
            document.getElementById('search-modal').classList.add('hidden');
        });
        
        document.getElementById('randomize-btn').addEventListener('click', () => {
            windowCount = windowCount >= imageConfig.maxCount ? imageConfig.defaultCount : windowCount + 1;
            generateWindows();
        });
        
        document.getElementById('restore-btn').addEventListener('click', () => {
            // Clear all popup hide timers
            localStorage.removeItem('hidden_text_window');
            localStorage.removeItem('hidden_badge');
            for (let i = 0; i < 20; i++) {
                localStorage.removeItem(`hidden_image_window_${i}`);
            }
            
            // Restore text window
            const textWindow = document.getElementById('text-window');
            if (textWindow) {
                textWindow.style.display = 'block';
                textWindow.style.animation = 'fadeIn 0.3s ease-in';
            }
            
            // Restore badge
            const badge = document.getElementById('badge');
            if (badge) {
                badge.style.display = 'block';
                badge.style.animation = 'fadeIn 0.3s ease-in';
            }
            
            // Reset window count to default and regenerate
            windowCount = imageConfig.defaultCount;
            generateWindows();
        });
        
        // CHAOS mode toggle function
        function toggleChaosMode() {
            chaosMode = !chaosMode;
            glitchMode = chaosMode; // Glitch is part of chaos
            
            // Save to localStorage
            localStorage.setItem('chaos-mode', chaosMode.toString());
            
            // Header button removed - only global button remains
            
            // Update global CHAOS button
            const globalBtn = document.getElementById('global-chaos-btn');
            if (globalBtn) {
                globalBtn.textContent = chaosMode ? 'STOP' : 'CHAOS';
                globalBtn.style.background = chaosMode ? '#ff0080' : '#ffc0cb';
            }
            
            if (chaosMode) {
                document.body.classList.add('glitch');
                
                // Continuous chaos mode
                chaosInterval = setInterval(() => {
                    // Random glitch effects
                    if (Math.random() < 0.3) {
                        document.body.style.filter = `hue-rotate(${rand(0, 360)}deg) saturate(${rand(0.5, 2)})`;
                        setTimeout(() => {
                            document.body.style.filter = '';
                        }, 200);
                    }
                    
                    // Randomly move existing windows
                    const existingWindows = document.querySelectorAll('#floating-windows .drag-element');
                    existingWindows.forEach(window => {
                        if (Math.random() < 0.4) {
                            window.style.left = rand(0, window.innerWidth - 300) + 'px';
                            window.style.top = rand(0, window.innerHeight - 200) + 'px';
                            window.style.transform = `rotate(${rand(-15, 15)}deg)`;
                        }
                    });
                    
                    // Chaos effects for posts and category/tag boxes
                    const posts = document.querySelectorAll('.grid > div');
                    posts.forEach(post => {
                        if (Math.random() < 0.3) {
                            post.style.transform = `rotate(${rand(-10, 10)}deg) scale(${rand(0.9, 1.1)})`;
                            post.style.filter = Math.random() < 0.2 ? `hue-rotate(${rand(0, 360)}deg)` : '';
                        }
                    });
                    
                    // Chaos effects for sidebar boxes
                    const sidebarBoxes = document.querySelectorAll('.space-y-6 > div');
                    sidebarBoxes.forEach(box => {
                        if (Math.random() < 0.2) {
                            box.style.transform = `rotate(${rand(-5, 5)}deg)`;
                            box.style.filter = Math.random() < 0.3 ? `saturate(${rand(0.5, 2)})` : '';
                        }
                    });
                    
                }, rand(800, 2000));
                
            } else {
                document.body.classList.remove('glitch');
                document.body.style.filter = '';
                if (chaosInterval) {
                    clearInterval(chaosInterval);
                    chaosInterval = null;
                }
            }
            
            if (typeof generateWindows === 'function') {
                generateWindows();
            }
        }
        
        // Header glitch button removed
        
        // Global CHAOS button
        document.getElementById('global-chaos-btn').addEventListener('click', toggleChaosMode);
        
        // Search functionality
        let searchData = null;
        
        // Load search data
        async function loadSearchData() {
            try {
                const response = await fetch('/assets/js/search-data.json?v=1754912052');
                searchData = await response.json();
            } catch (error) {
                console.error('Failed to load search data:', error);
            }
        }
        
        // Search function
        function performSearch(query) {
            if (!searchData || query.length < 2) {
                return [];
            }
            
            query = query.toLowerCase();
            
            return searchData.posts.filter(post => {
                return post.title.toLowerCase().includes(query) ||
                       post.content.toLowerCase().includes(query) ||
                       post.categories.some(cat => cat.toLowerCase().includes(query)) ||
                       post.tags.some(tag => tag.toLowerCase().includes(query));
            }).slice(0, 10); // Limit to 10 results
        }
        
        // Display search results
        function displaySearchResults(results, query) {
            const modal = document.getElementById('search-modal');
            const existingResults = modal.querySelector('.search-results');
            if (existingResults) {
                existingResults.remove();
            }
            
            if (results.length === 0 && query.length >= 2) {
                const noResults = document.createElement('div');
                noResults.className = 'search-results mt-4 p-4 border-4 border-black bg-gray-100';
                noResults.innerHTML = '<p class="font-mono text-center">검색 결과가 없습니다.</p>';
                modal.querySelector('.relative').appendChild(noResults);
                return;
            }
            
            if (results.length > 0) {
                const resultsDiv = document.createElement('div');
                resultsDiv.className = 'search-results mt-4 max-h-96 overflow-y-auto';
                
                results.forEach(post => {
                    const resultItem = document.createElement('div');
                    resultItem.className = 'border-4 border-black bg-white p-3 mb-2 brutal-shadow hover:bg-gray-50 cursor-pointer';
                    resultItem.innerHTML = `
                        <h3 class="font-bold text-lg mb-1">${post.title}</h3>
                        <p class="text-sm text-gray-600 mb-2">${post.date} • ${post.categories.join(', ')}</p>
                        <p class="text-sm">${post.excerpt.substring(0, 150)}...</p>
                    `;
                    
                    resultItem.addEventListener('click', () => {
                        window.location.href = post.url;
                    });
                    
                    resultsDiv.appendChild(resultItem);
                });
                
                modal.querySelector('.relative').appendChild(resultsDiv);
            }
        }
        
        document.getElementById('search-input').addEventListener('input', (e) => {
            const query = e.target.value.toLowerCase();
            const results = performSearch(query);
            displaySearchResults(results, query);
        });
        
        // Close search on escape
        document.addEventListener('keydown', (e) => {
            if (e.key === 'Escape') {
                document.getElementById('search-modal').classList.add('hidden');
            }
        });
        
        // Filter posts by category or tag
        function filterPosts(type, value) {
            const posts = document.querySelectorAll('.post-item');
            const filterBtns = document.querySelectorAll('.filter-btn');
            
            // Remove active class from all buttons
            filterBtns.forEach(btn => btn.classList.remove('active'));
            
            if (type === 'all') {
                // Show all posts
                posts.forEach(post => post.classList.remove('hidden'));
                document.querySelector('[data-filter="all"]').classList.add('active');
            } else if (type === 'category') {
                // Filter by category
                posts.forEach(post => {
                    const categories = post.getAttribute('data-categories').split(',');
                    if (categories.includes(value.toLowerCase())) {
                        post.classList.remove('hidden');
                    } else {
                        post.classList.add('hidden');
                    }
                });
                document.querySelector(`[data-filter="${value}"]`).classList.add('active');
            } else if (type === 'tag') {
                // Filter by tag
                posts.forEach(post => {
                    const tags = post.getAttribute('data-tags').split(',');
                    if (tags.includes(value.toLowerCase())) {
                        post.classList.remove('hidden');
                    } else {
                        post.classList.add('hidden');
                    }
                });
                // Find and activate the tag button
                const tagBtns = document.querySelectorAll('.tag-btn');
                tagBtns.forEach(btn => {
                    if (btn.textContent === '#' + value) {
                        btn.classList.add('active');
                    }
                });
            }
        }
        
        // Close functions for individual popups
        function closeTextWindow() {
            const textWindow = document.getElementById('text-window');
            hidePopupForHour('text_window');
            textWindow.style.display = 'none';
        }
        
        function closeBadge() {
            const badge = document.getElementById('badge');
            hidePopupForHour('badge');
            badge.style.display = 'none';
        }
        
        // Initialize on load
        document.addEventListener('DOMContentLoaded', () => {
            // Initialize CHAOS mode button state first
            const globalBtn = document.getElementById('global-chaos-btn');
            if (chaosMode && globalBtn) {
                globalBtn.textContent = 'STOP';
                globalBtn.style.background = '#ff0080';
                document.body.classList.add('glitch');
            }
            
            // Show popups only if they weren't closed in the last hour
            if (!isPopupHidden('text_window')) {
                document.getElementById('text-window').style.display = 'block';
            }
            if (!isPopupHidden('badge')) {
                document.getElementById('badge').style.display = 'block';
            }
            
            // 기본 창 개수 설정
            windowCount = imageConfig.defaultCount;
            // Generate windows based on current CHAOS mode state
            generateWindows();
            
            // Add initial draggable functionality to static elements
            initializeDraggables();
            
            // Load search data
            loadSearchData();
            
            // Start chaos interval if CHAOS mode was previously active
            if (chaosMode) {
                
                // Start chaos interval
                chaosInterval = setInterval(() => {
                    if (Math.random() < 0.3) {
                        document.body.style.filter = `hue-rotate(${rand(0, 360)}deg) saturate(${rand(0.5, 2)})`;
                        setTimeout(() => {
                            document.body.style.filter = '';
                        }, 200);
                    }
                    
                    const existingWindows = document.querySelectorAll('#floating-windows .drag-element');
                    existingWindows.forEach(window => {
                        if (Math.random() < 0.4) {
                            window.style.left = rand(0, window.innerWidth - 300) + 'px';
                            window.style.top = rand(0, window.innerHeight - 200) + 'px';
                            window.style.transform = `rotate(${rand(-15, 15)}deg)`;
                        }
                    });
                    
                    // Chaos effects for posts and category/tag boxes
                    const posts = document.querySelectorAll('.grid > div');
                    posts.forEach(post => {
                        if (Math.random() < 0.3) {
                            post.style.transform = `rotate(${rand(-10, 10)}deg) scale(${rand(0.9, 1.1)})`;
                            post.style.filter = Math.random() < 0.2 ? `hue-rotate(${rand(0, 360)}deg)` : '';
                        }
                    });
                    
                    // Chaos effects for sidebar boxes
                    const sidebarBoxes = document.querySelectorAll('.space-y-6 > div');
                    sidebarBoxes.forEach(box => {
                        if (Math.random() < 0.2) {
                            box.style.transform = `rotate(${rand(-5, 5)}deg)`;
                            box.style.filter = Math.random() < 0.3 ? `saturate(${rand(0.5, 2)})` : '';
                        }
                    });
                }, rand(800, 2000));
            }
        });
        
        // Mobile optimizations
        function optimizeForMobile() {
            const isMobile = window.innerWidth < 768;
            const isVerySmall = window.innerWidth < 480;
            
            if (isMobile) {
                // Reduce number of windows on mobile
                windowCount = Math.min(windowCount, isVerySmall ? 1 : 2);
                
                // Make windows smaller on mobile
                const mobileWindows = document.querySelectorAll('#floating-windows .drag-element');
                mobileWindows.forEach(window => {
                    window.style.width = isVerySmall ? '150px' : '200px';
                    window.style.height = isVerySmall ? '120px' : '150px';
                });
                
                // Hide floating elements on mobile to avoid interference
                const textWindow = document.getElementById('text-window');
                const badge = document.getElementById('badge');
                if (textWindow && (!isPopupHidden('text_window'))) {
                    textWindow.style.display = isVerySmall ? 'none' : 'block';
                }
                if (badge && (!isPopupHidden('badge'))) {
                    badge.style.display = isVerySmall ? 'none' : 'block';
                }
            } else {
                // Show elements on larger screens only if not hidden by user
                const textWindow = document.getElementById('text-window');
                const badge = document.getElementById('badge');
                if (textWindow && (!isPopupHidden('text_window'))) {
                    textWindow.style.display = 'block';
                }
                if (badge && (!isPopupHidden('badge'))) {
                    badge.style.display = 'block';
                }
            }
        }
        
        // Responsive behavior
        window.addEventListener('resize', () => {
            // Reposition windows if they're off-screen
            dragElements.forEach(element => {
                const rect = element.getBoundingClientRect();
                if (rect.right > window.innerWidth || rect.bottom > window.innerHeight) {
                    element.style.left = Math.min(element.offsetLeft, window.innerWidth - element.offsetWidth) + 'px';
                    element.style.top = Math.min(element.offsetTop, window.innerHeight - element.offsetHeight) + 'px';
                }
            });
            
            // Regenerate windows based on screen size
            generateWindows();
            optimizeForMobile();
        });
        
    </script>
</body>
</html>